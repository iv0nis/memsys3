# Context - memsys3
# Compilado autom√°ticamente por Context Agent
# Este es el contexto optimizado que los Development Agents leen al iniciar sesi√≥n
#
# NOTA: README.md se lee directamente en newSession.md (ADR-012: identidad actual del proyecto)
#       context.yaml contiene solo memoria hist√≥rica (sessions, ADRs, gotchas)

metadata:
  compilado_por: "Context Agent"
  ultima_compilacion: "2025-12-04"
  version_context: "1.10"

# ============================================
# PROJECT INFO
# ============================================
project:
  nombre: "memsys3"
  descripcion: "Sistema de gesti√≥n de contexto para AI Development Agents"
  fase: "Development v1.9"
  ultima_feature: "IMPROVEMENT-004 completado + Sistema rotaci√≥n flexible documentado. README lectura directa en newSession (Separation of Concerns). compile-context sin PASO 7 (-260 l√≠neas). ADR-012 creado. Primera rotaci√≥n real ejecutada (sessions_1.yaml, 1849 l√≠neas). Sistema rotaci√≥n mejorado: flexible 1800-2000 (post-documentar LITE) vs >2000 (pre-documentar). endSession.md + ADR-002 actualizados con 2 escenarios. Resuelto conflicto IMPROVEMENT-001 vs 004. 13 archivos (+445/-2515 l√≠neas). ~3h."
  siguiente_milestone: "Testing compile-context sin README + Validar rotaci√≥n flexible + Reconsiderar IMPROVEMENT-001"

# ============================================
# FEATURES OPERATIVAS
# ============================================
features:
  context_agent:
    nombre: "Context Agent"
    estado: "operativo"
    descripcion: "Agente que compila contexto completo con criterio inteligente (m√°x 2000 l√≠neas). Filosof√≠a: '¬øQu√© debe saber CUALQUIER agent descontextualizado?'"

  rotacion_automatica:
    nombre: "Rotaci√≥n Autom√°tica Flexible"
    estado: "operativo"
    descripcion: "Sistema rotaci√≥n sessions/ADRs flexible: 1800-2000 l√≠neas (post-documentar LITE) vs >2000 (pre-documentar). Evita duplicaci√≥n sesi√≥n actual"

  plan_contingencia:
    nombre: "Plan de Contingencia"
    estado: "operativo"
    descripcion: "Archivado inteligente a history/ cuando >150K tokens. Reduce a ~120K preservando datos"

  visualizador:
    nombre: "Memory Visualizer"
    estado: "operativo"
    descripcion: "Dashboard web para ver la 'mente' de los agentes (4 pesta√±as: Agent View, Full History, Project Status, Stats)"

  prompts:
    nombre: "Prompts Reutilizables"
    estado: "operativo"
    descripcion: "newSession, endSession, compile-context, mind, deploy, actualizar, actualizar_cat, backlog, github - TODOS con rutas memsys3/"

  sistema_rutas:
    nombre: "Sistema de Rutas Unificado"
    estado: "operativo"
    descripcion: "TODAS las rutas usan prefijo memsys3/ para portabilidad y claridad (ADR-006)"

  backlog_distribuible:
    nombre: "Sistema Backlog Distribuible"
    estado: "operativo"
    descripcion: "memsys3/backlog/ con README agn√≥stico (315 l√≠neas) + 3 ejemplos ilustrativos + prompt backlog.md (3 operaciones: consultar, crear, actualizar). 6 tipos de items: ISSUE, FEATURE, SPEC, BLUEPRINT, IMPROVEMENT, EXPLORATION"

  readme_separado:
    nombre: "README Lectura Directa"
    estado: "operativo"
    descripcion: "README.md se lee directamente en newSession (ADR-012). Separation of Concerns: README = identidad actual, context = memoria hist√≥rica"

# ============================================
# STACK TECNOL√ìGICO
# ============================================
stack:
  frontend: "HTML/CSS/JS (visualizador web)"
  backend: "Python 3.x (servidor visualizador)"
  database: "Ninguno (YAML files como almacenamiento)"
  deploy: "GitHub + clonado local"
  lenguaje_docs: "YAML + Markdown"

# ============================================
# URLS PRINCIPALES
# ============================================
urls:
  repository: "https://github.com/iv0nis/memsys3"

# ============================================
# ADRs RELEVANTES (12 totales, 8 incluidas)
# Seleccionadas con criterio inteligente seg√∫n impacto global
# ============================================
adrs:
  - id: "001"
    titulo: "Criterio inteligente del Context Agent vs l√≠mites arbitrarios"
    decision: "El Context Agent usa criterio inteligente bas√°ndose en la pregunta: '¬øQu√© debe saber CUALQUIER agent descontextualizado para trabajar aqu√≠?'. L√≠mite √öNICO: m√°ximo 2000 l√≠neas en context.yaml final. NO hay l√≠mites arbitrarios para ADRs, sessions, gotchas, etc."
    motivo: "Los sistemas anteriores usaban l√≠mites r√≠gidos (m√°x 7 ADRs, m√°x 15 l√≠neas por sesi√≥n) que no se adaptaban a la realidad del proyecto. Proyectos peque√±os perd√≠an contexto, proyectos grandes no pod√≠an expresarse adecuadamente."
    impacto: "Contexto adaptativo seg√∫n necesidades del proyecto. CA decide con visi√≥n panor√°mica completa. Proyectos peque√±os mantienen todo, proyectos grandes filtran inteligentemente. M√°s flexible y escalable."

  - id: "002"
    titulo: "Rotaci√≥n autom√°tica de sessions/ADRs (flexible 1800-2000 l√≠neas)"
    decision: |
      Sistema de rotaci√≥n flexible con dos escenarios:

      **Escenario A: 1800 < l√≠neas < 2000** (Rotaci√≥n LITE post-documentaci√≥n)
      1. Documentar sesi√≥n normalmente en sessions.yaml
      2. DESPU√âS de documentar, si supera 1800 l√≠neas:
         - Copiar sessions.yaml ‚Üí sessions_N.yaml (incluye sesi√≥n actual)
         - Verificar copia (debe tener sesi√≥n actual)
         - Crear nuevo sessions.yaml VAC√çO (solo header YAML)
      3. Resultado: Sesi√≥n actual SOLO en sessions_N.yaml (no duplicaci√≥n)

      **Escenario B: l√≠neas > 2000** (Rotaci√≥n PRE-documentaci√≥n)
      1. ANTES de documentar, rotar:
         - Copiar sessions.yaml ‚Üí sessions_N.yaml (sin sesi√≥n actual)
         - Crear nuevo sessions.yaml vac√≠o
      2. Documentar sesi√≥n actual en sessions.yaml NUEVO
      3. Resultado: Sesi√≥n actual SOLO en sessions.yaml nuevo

      Context Agent lee TODOS los archivos rotados hasta detectar >150K tokens.
    motivo: "Read tool tiene l√≠mite de 2000 l√≠neas. Si sessions.yaml o adr.yaml crecen demasiado, agents no pueden leerlos. Sistema mejorado tras primera rotaci√≥n real (sessions.yaml 1849 l√≠neas) aprovecha espacio disponible 1800-2000 y evita duplicaci√≥n"
    impacto: "Sistema escala infinitamente. No se pierden datos nunca. Autom√°tico sin intervenci√≥n manual. Rotaci√≥n flexible m√°s eficiente: no rota r√≠gidamente en 1800, aprovecha espacio hasta 2000. Evita duplicaci√≥n: sesi√≥n actual solo en un archivo"

  - id: "003"
    titulo: "Plan de Contingencia con archivado inteligente (>150K tokens)"
    decision: |
      Cuando total de full/ supera 150K tokens:
      1. CA identifica ADRs/sessions irrelevantes con criterio inteligente
      2. Los mueve a memory/history/ (que NO se lee)
      3. Reduce a ~120K tokens
      4. Contin√∫a compilaci√≥n normal

      Datos en history/ est√°n preservados, recuperables si es necesario.
    motivo: "Incluso con rotaci√≥n, proyectos muy grandes pueden acumular demasiados datos. Si full/ (con todos los archivos rotados) supera 150K tokens, el CA no puede procesarlo eficientemente."
    impacto: "Ahorro real de tokens (history/ NO se lee). Datos preservados, no perdidos. Sistema escala ilimitadamente. Reversible (puedes recuperar de history/)."

  - id: "005"
    titulo: "deploy.md como prompt (no script shell)"
    decision: |
      Crear prompts/deploy.md que el Main-Agent ejecuta.
      El agent hace briefing con user para personalizar el deployment:
      - Pregunta sobre proyecto, stack, comportamiento
      - Copia templates
      - Crea archivos espec√≠ficos bas√°ndose en respuestas

      M√°s flexible que script autom√°tico.
    motivo: "Necesit√°bamos manera de desplegar memsys3 en nuevos proyectos. Script shell autom√°tico no puede hacer briefing con user ni adaptarse a respuestas"
    impacto: "Deployment guiado e inteligente. Personalizaci√≥n seg√∫n necesidades. Agent puede adaptarse a respuestas. Consistente con filosof√≠a de prompts"

  - id: "006"
    titulo: "Sistema de rutas unificado memsys3/"
    decision: |
      TODAS las rutas en memsys3_templates/ deben usar el prefijo `memsys3/`:

      - `memsys3/memory/context.yaml`
      - `memsys3/agents/main-agent.yaml`
      - `memsys3/prompts/compile-context.md`
      - etc.

      Raz√≥n: Durante deployment, memsys3_templates/ se copia a la ra√≠z del proyecto
      como `memsys3/`, por lo tanto todas las rutas internas funcionan correctamente.

      Adem√°s:
      - compile-context.md debe referenciar expl√≠citamente `memsys3/agents/context-agent.yaml`
      - main-agent.yaml incluye restricci√≥n de NO proponer compile-context.md
      - READMEs separados por meta-nivel (repositorio vs sistema desplegado)
    motivo: "Durante el desarrollo inicial se cre√≥ confusi√≥n sobre las rutas en el sistema. Los prompts referencian archivos usando rutas relativas, pero cuando memsys3 se despliega en diferentes proyectos, esas rutas deben ser consistentes."
    impacto: "Claridad total: siempre se sabe que es de memsys3. Portabilidad: funciona en cualquier proyecto. Actualizable: f√°cil saber qu√© archivos actualizar. Sin conflictos con carpetas del proyecto."

  - id: "008"
    titulo: "Main-Agent NO debe proponer compile-context"
    decision: |
      Main-Agent tiene restricci√≥n expl√≠cita en agents/main-agent.yaml:
      - NO proponer ejecutar @memsys3/prompts/compile-context.md
      - Solo sugerir endSession al finalizar sesi√≥n
      - El user decide cu√°ndo compilar (en nueva instancia limpia)

      compile-context.md debe ejecutarse en una NUEVA INSTANCIA sin tokens acumulados.
    motivo: "El Main-Agent trabaja durante sesiones acumulando tokens. compile-context.md requiere leer TODOS los archivos de memory/full/ (puede ser >50K tokens). Si Main-Agent propone ejecutar compile-context, acumula tokens de sesi√≥n + tokens de leer todo memory/full/ + tokens de generar context.yaml. Ineficiente y puede superar l√≠mites"
    impacto: "Eficiencia de tokens optimizada. Main-Agent se enfoca en desarrollo. Context Agent trabaja con instancia limpia. User controla cu√°ndo compilar"

  - id: "009"
    titulo: "Templates como documentaci√≥n activa permanente + gotchas en sessions"
    decision: |
      **1. memory/templates/ = Gu√≠as permanentes:**
      - Main-Agent consulta templates/ durante endSession.md
      - "¬øC√≥mo estructuro esta sesi√≥n?" ‚Üí sessions-template.yaml
      - "¬øQu√© campos tiene un ADR?" ‚Üí adr-template.yaml
      - Templates son documentaci√≥n ACTIVA, no solo gu√≠as de deployment
      - NO se borran despu√©s del deployment

      **2. Gotchas documentados en sessions.yaml:**
      - Main-Agent documenta gotchas en cada sesi√≥n donde aparecen
      - Estructura en sessions.yaml:
        ```yaml
        sessions:
          - id: "2025-10-31"
            gotchas:
              - tipo: "warning|gotcha|issue"
                problema: "[DESCRIPCI√ìN]"
                solucion: "[C√ìMO RESOLVER]"
                criticidad: "alta|media|baja"
        ```
      - Context-Agent extrae gotchas de TODAS las sesiones
      - CA usa criterio inteligente para seleccionar top 5 m√°s cr√≠ticos
      - project-status.yaml NO contiene gotchas (solo info general del proyecto)
    motivo: "Durante validaci√≥n deployment surgi√≥ confusi√≥n sobre uso de templates/ y ubicaci√≥n de gotchas. Templates contienen estructura exacta, instrucciones de uso, ejemplos de buena vs mala documentaci√≥n - informaci√≥n que endSession.md no detalla. Gotchas surgen DURANTE sesiones de trabajo, no son caracter√≠sticas est√°ticas del proyecto"
    impacto: "Main-Agent siempre tiene referencia de c√≥mo documentar correctamente. Gotchas contextualizados (cu√°ndo aparecieron, en qu√© sesi√≥n). CA tiene flexibilidad para priorizar gotchas seg√∫n criterio. project-status.yaml m√°s limpio (solo info general). ~15KB extra en proyecto (4 templates, aceptable)"

  - id: "012"
    titulo: "README como lectura directa vs duplicado en context.yaml"
    decision: |
      README.md se lee DIRECTAMENTE en newSession.md, NO se incluye en context.yaml.

      Cambios implementados:

      1. newSession.md:
         - Agregada instrucci√≥n expl√≠cita: "Lee README.md del proyecto"
         - Orden de carga: README.md ‚Üí project-status.yaml ‚Üí context.yaml
         - README proporciona identidad actual, context proporciona memoria hist√≥rica

      2. compile-context.md:
         - ELIMINADO "Paso Previo: Verificar README.md" (creaci√≥n autom√°tica)
         - ELIMINADO "PASO 7: An√°lisis profundo README" (comparaci√≥n vs realidad)
         - ELIMINADO de lista de archivos a leer
         - Context Agent ya NO incluye README en el contexto compilado

      3. context-template.yaml:
         - ELIMINADA secci√≥n `readme_proyecto:`
         - Agregado comentario: "README.md se lee directamente en newSession.md"

      Filosof√≠a: Separation of Concerns
      - README = Identidad actual (fuente de verdad, siempre actualizada)
      - context = Memoria hist√≥rica (s√≠ntesis de aprendizajes)
    motivo: "Durante deployment en otros proyectos se detect√≥ que README.md cambia frecuentemente (versiones, features nuevas, URLs, stack), pero context.yaml solo se actualiza cuando se ejecuta compile-context.md. Problema: README sintetizado en context.yaml quedaba desactualizado, requer√≠a re-ejecutar compile-context por cambios triviales en README, an√°lisis README parad√≥jico (comparar contra s√≠ mismo)"
    impacto: "Imposible desincronizaci√≥n: README siempre es la versi√≥n actual. No duplicaci√≥n: una sola fuente de verdad. Menos mantenimiento: no re-compilar por cambios en README. Overhead trivial: 1 Read adicional (~200-400 l√≠neas) es irrelevante. Coherencia conceptual: README = identidad, context = memoria. compile-context m√°s enfocado: solo memoria hist√≥rica. ~95 l√≠neas menos en context.yaml (~1.4K tokens ahorrados)"

# ============================================
# SESIONES RECIENTES (15 totales, 4 incluidas)
# Sintetizadas con criterio de impacto arquitect√≥nico
# ============================================
sesiones_recientes:
  - id: "2025-12-03"
    data: "2025-12-03"
    titulo: "IMPROVEMENT-004 + Sistema Rotaci√≥n Flexible Documentado"
    duracion: "~3h"

    que_se_hizo:
      - "IMPROVEMENT-004 completado: README como lectura directa vs duplicado context.yaml"
      - "5 archivos modificados memsys3_templates/: newSession.md, compile-context.md (-260 l√≠neas), context-template.yaml, adr.yaml (+106 ADR-012), README.md"
      - "ADR-012 creado: Separation of Concerns (README = identidad actual, context = memoria hist√≥rica)"
      - "Deployment en memsys3/ (dog-fooding completo)"
      - "Rotaci√≥n autom√°tica ejecutada: sessions.yaml (1849 l√≠neas) ‚Üí sessions_1.yaml"
      - "Sistema rotaci√≥n mejorado: flexible 1800-2000 (post-documentar) vs >2000 (pre-documentar)"
      - "Actualizado endSession.md con Escenario A y Escenario B"
      - "Actualizado ADR-002 con sistema rotaci√≥n mejorado (UPDATE 2025-12-03)"

    decisiones_clave:
      - "README.md lectura directa en newSession, NO en context.yaml (evitar desincronizaci√≥n)"
      - "Sistema rotaci√≥n flexible: aprovechar espacio 1800-2000, evitar duplicaci√≥n sesi√≥n actual"
      - "Resuelto conflicto IMPROVEMENT-001 vs 004 (004 m√°s madura arquitect√≥nicamente)"

    proximos_pasos:
      - "Testing compile-context en proyecto real para validar README NO incluido"
      - "Reconsiderar IMPROVEMENT-001 para DEVELOPMENT.md, UPDATE.md seg√∫n necesidad"
      - "Validar sistema rotaci√≥n flexible en pr√≥xima sesi√≥n que supere 1800 l√≠neas"

  - id: "2025-12-01"
    data: "2025-12-01"
    titulo: "Compilaci√≥n Context v1.9 + Actualizaci√≥n README + Planning Sync Metadata"
    duracion: "~2h"

    que_se_hizo:
      - "Compilaci√≥n exitosa context.yaml v1.9 (403 l√≠neas, 8 ADRs, 4 sesiones, 5 gotchas)"
      - "PASO 7 ejecutado: An√°lisis profundo README autom√°tico con 10 categor√≠as (A-J)"
      - "Identificadas 8 discrepancias: 1 cr√≠tica (versi√≥n 1.6‚Üí1.9), 3 importantes, 4 mejoras"
      - "README.md actualizado: versi√≥n 1.9, fecha actualizaci√≥n, 3 features recientes agregadas, warning @ mentions, secci√≥n Stack Tecnol√≥gico"
      - "Planning mejora: Opci√≥n A mejorada para sincronizaci√≥n autom√°tica metadata en github.md"
      - "IMPROVEMENT-003 creado en backlog documentando mejora propuesta"

    decisiones_clave:
      - "Actualizar memsys3_version en project-status.yaml durante compile-context, no esperar a github.md (sincronizaci√≥n inmediata versi√≥n context.yaml ‚Üî project-status.yaml ‚Üî README.md)"
      - "Opci√≥n A mejorada: separar versi√≥n sem√°ntica (manual) de commit hash (autom√°tico) y fecha push"

  - id: "2025-11-14"
    data: "2025-11-14"
    titulo: "Mejora Context Agent: An√°lisis README Autom√°tico + Integraci√≥n Backlog Selectiva"
    duracion: "~3h"

    que_se_hizo:
      - "MEJORA CR√çTICA compile-context.md: An√°lisis profundo README autom√°tico (PASO 7 obligatorio)"
      - "10 categor√≠as exhaustivas (A-J) con evidencia concreta: Versi√≥n, Features, Decisiones arquitect√≥nicas, Stack, Prompts, Pendientes, Gotchas, Backlog, Enlaces, Historial"
      - "Reporte estructurado autom√°tico con 3 niveles de severidad (üî¥ CR√çTICA, üü° IMPORTANTE, üü¢ MEJORA)"
      - "Optimizaci√≥n: CA usa datos ya en memoria (200K tokens), NO releer archivos"
      - "Integraci√≥n backlog con lectura selectiva: Lee backlog/README.md + cuenta items + lee SOLO items referenciados en pendientes_prioritarios"
      - "Nueva secci√≥n backlog en context-template.yaml (sistema, estad√≠sticas, items_criticos)"
      - "compile-context.md: +309 l√≠neas (378 ‚Üí 629 l√≠neas)"
      - "context-template.yaml: +34 l√≠neas (153 ‚Üí 183 l√≠neas)"

    decisiones_clave:
      - "An√°lisis README debe ser AUTOM√ÅTICO (PASO 7 en Fase 2), no pregunta opcional. CA ya tiene TODO en memoria despu√©s de compilar, aprovechar 200K tokens evita relecturas"
      - "Backlog: Elegida Opci√≥n B (lectura selectiva) vs A (no leer) o C (leer todo). Escalable (funciona con 5 o 50 items), eficiente (lee solo referenciados), contextual (da visi√≥n futuro)"

    meta_aprendizaje:
      - "Context Agent tiene 200K tokens de contexto - debe aprovecharse haciendo an√°lisis en el mismo flujo de compilaci√≥n, no como paso posterior opcional"
      - "An√°lisis profundo con evidencia concreta (l√≠nea exacta + impacto) es mucho m√°s √∫til que pregunta gen√©rica '¬øest√° actualizado?'"
      - "Lectura selectiva es clave para escalabilidad: leer TODO el backlog puede saturar tokens, leer NADA pierde contexto. Opci√≥n B (selectiva) es el balance correcto"

  - id: "2025-11-14"
    data: "2025-11-14"
    titulo: "Feature Backlog: De dog-fooding a sistema distribuible"
    duracion: "~2h"

    que_se_hizo:
      - "Sistema Backlog convertido de feature espec√≠fica (docs/backlog/) a feature distribuible (memsys3/backlog/)"
      - "README.md agn√≥stico creado (315 l√≠neas) con 3 ejemplos ilustrativos integrados (ISSUE, FEATURE, IMPROVEMENT)"
      - "Prompt backlog.md mejorado (38 l√≠neas) con 3 operaciones: Consultar, Crear, Actualizar"
      - "Desplegado en 4 ubicaciones: memsys3_templates/, memsys3/, Fundamentos de Programaci√≥n, pokerezza-html"
      - "Migraci√≥n completa: 3 items movidos docs/backlog/ ‚Üí memsys3/backlog/"
      - "Eliminado docs/backlog/ completamente: sistema unificado en memsys3/backlog/"

    decisiones_clave:
      - "Eliminar docs/backlog/ y consolidar todo en memsys3/backlog/. Duplicaci√≥n generaba confusi√≥n. memsys3/backlog/ puede contener items reales de desarrollo (dog-fooding) y memsys3_templates/backlog/ se distribuye vac√≠o (solo README)"
      - "README agn√≥stico con ejemplos integrados (no archivos separados). Usuarios pueden ver formato completo leyendo solo README"

    arquitectura_final:
      - "memsys3/backlog/ = backlog activo con items reales (dog-fooding de memsys3): README.md agn√≥stico + 7 items"
      - "memsys3_templates/backlog/ = producto distribuible (solo README vac√≠o). Durante deployment se copia a proyectos vac√≠o, usuarios crean sus propios items"

# ============================================
# GOTCHAS CR√çTICOS
# Top 5 m√°s cr√≠ticos de todas las sesiones
# ============================================
gotchas:
  - id: "endsession_history_folder"
    problema: "endSession.md sin warning expl√≠cito puede causar que agentes creen archivos detallados en memory/history/ (confundiendo su prop√≥sito: Plan Contingencia vs documentaci√≥n activa)"
    solucion: "‚ö†Ô∏è NO crear archivos detallados en memory/history/ - toda la info va DIRECTAMENTE en sessions.yaml. Aclarar que history/ es SOLO para archivado >150K tokens (Plan de Contingencia ADR-003)"
    criticidad: "media"
    contexto: "Detectado en tallersColomer donde 3 sesiones crearon archivos incorrectos (session-2025-11-13-*.yaml)"

  - id: "mentions_archivos_ignorados"
    problema: "@ mentions NO funcionan con archivos ignorados en .gitignore (limitaci√≥n Claude Code)"
    solucion: "Workaround: usar instrucciones directas en lugar de @ mentions. Ejemplo: 'Ejecuta memsys3/prompts/newSession.md' en lugar de '@memsys3/prompts/newSession.md'"
    criticidad: "media"
    contexto: "Documentado en deploy.md PASO 8 con warning expl√≠cito. ADR-010 actualizado con UPDATE 2025-11-13"

  - id: "rotacion_flexible_evitar_duplicacion"
    problema: "Rotaci√≥n r√≠gida en 1800 l√≠neas no aprovechaba espacio disponible (1800-2000) y pod√≠a duplicar sesi√≥n actual"
    solucion: "Sistema flexible: Escenario A (1800-2000 post-documentar LITE) vs Escenario B (>2000 pre-documentar). Sesi√≥n actual queda solo en un archivo"
    criticidad: "alta"
    contexto: "Mejorado tras primera rotaci√≥n real (sessions.yaml 1849 l√≠neas). Documentado en endSession.md y ADR-002 UPDATE 2025-12-03"

  - id: "context_agent_criterio_inteligente"
    problema: "CA debe leer TODO primero, despu√©s decidir con criterio. NO l√≠mites r√≠gidos arbitrarios (m√°x 7 ADRs, m√°x 15 l√≠neas sesi√≥n, etc.)"
    solucion: "Filosof√≠a: '¬øQu√© debe saber CUALQUIER agent descontextualizado para trabajar aqu√≠?'. L√≠mite √öNICO: m√°x 2000 l√≠neas context.yaml. Criterio basado en impacto global, relevancia, informaci√≥n no obvia"
    criticidad: "alta"
    contexto: "ADR-001: sistemas anteriores con l√≠mites r√≠gidos no se adaptaban a realidad del proyecto"

  - id: "templates_documentacion_activa"
    problema: "memory/templates/ puede parecer residual post-deployment, pero son documentaci√≥n ACTIVA"
    solucion: "NO borrar memory/templates/ despu√©s del deployment. Main-Agent consulta templates/ durante endSession.md para estructurar correctamente sessions, ADRs, etc."
    criticidad: "media"
    contexto: "ADR-009: Templates contienen estructura exacta, instrucciones de uso, ejemplos de buenas pr√°cticas que endSession.md no detalla"

# ============================================
# PENDIENTES PRIORITARIOS
# Del project-status.yaml actual
# ============================================
pendientes:
  - prioritat: 1
    tasca: "Testear deployment con consulta .gitignore en nuevo proyecto"
    detall: "Validar que PASO 8 funciona correctamente con warning @ mentions y usuario puede elegir Opci√≥n A o B"

  - prioritat: 2
    tasca: "Testear actualizar_cat.md en futuras sincronizaciones"
    detall: "Cuando haya nuevos cambios en master, validar que actualizar_cat.md sincroniza y traduce correctamente a branch catalan"

  - prioritat: 3
    tasca: "Testear actualizar.md en proyecto con estructura correcta (Escenario C)"
    detall: "Validar actualizaci√≥n en proyecto que solo tenga /memsys3 (no estructura antigua). Probar en Soluzzia."

  - prioritat: 4
    tasca: "Validar compile-context.md con creaci√≥n autom√°tica de README"
    detall: "Ejecutar compile-context en deCastro (sin README), probar Opci√≥n A (crear autom√°ticamente desde project-status.yaml)"

  - prioritat: 5
    tasca: "IMPROVEMENT-001 PARCIALMENTE RESUELTO - Evaluar siguiente fase"
    detall: "README ya incluido en contexto (opcional). Evaluar si agregar DEVELOPMENT.md, UPDATE.md seg√∫n necesidad"

# ============================================
# BACKLOG
# Sistema de gesti√≥n de trabajo futuro
# ============================================
backlog:
  sistema: |
    Sistema de gesti√≥n de trabajo futuro estructurado con 6 tipos de items:
    - ISSUE-XXX: Problemas t√©cnicos, bugs, tech debt
    - FEATURE-XXX: Nueva funcionalidad a implementar
    - SPEC-XXX: Especificaci√≥n t√©cnica detallada
    - BLUEPRINT-XXX: Dise√±o arquitect√≥nico de alto nivel
    - IMPROVEMENT-XXX: Mejora de funcionalidad existente
    - EXPLORATION-XXX: Investigaci√≥n sin soluci√≥n clara

    Estados: Propuesto, Abierto, En Progreso, Bloqueado, Completado, Cancelado

    Workflow: Backlog (futuro) ‚Üí Sessions (hacer) ‚Üí ADRs (decidir) ‚Üí Project Status (ahora)

  estadisticas:
    issues: "2 (ISSUE-001 escalabilidad, ISSUE-002 versionado git)"
    features: "1 (FEATURE-002 prompt actualizar completado)"
    improvements: "4 (IMPROVEMENT-001 docs cr√≠ticas parcial, IMPROVEMENT-002 contexto espec√≠fico propuesto, IMPROVEMENT-003 sync metadata propuesto, IMPROVEMENT-004 README separado completado)"
    specs: "0"
    blueprints: "0"
    exploraciones: "0"
    total: "7 items"

  items_criticos:
    - id: "IMPROVEMENT-004"
      titulo: "README como lectura directa vs duplicado en context.yaml"
      estado: "‚úÖ Completado"
      prioridad: "Media-Alta"
      resumen: "README.md se lee directamente en newSession (identidad actual), NO en context.yaml (memoria hist√≥rica). Elimina riesgo desincronizaci√≥n, simplifica compile-context (-260 l√≠neas), ahorra ~1.4K tokens"
      fecha_completado: "2025-12-03"
      referencias: "ADR-012, sesi√≥n 2025-12-03, IMPROVEMENT-001 reconsiderada"

    - id: "ISSUE-002"
      titulo: "Inconsistencia entre Versionado Git Tags vs Versi√≥n Interna"
      estado: "Pendiente"
      prioridad: "Media"
      resumen: "Versi√≥n interna v1.9 (project-status.yaml, context.yaml, README.md) vs Git tag v0.7.1. Dos sistemas de versionado no sincronizados. Resolver antes de v1.0.0 estable"
      opciones: "Opci√≥n A (recomendada): Unificar en v0.x.x hasta estable. Opci√≥n B: Sincronizar git tags con versi√≥n interna. Opci√≥n C: Sistema dual expl√≠cito (no recomendada)"
      referencias: "Sesi√≥n 2025-12-01, github.md l√≠nea 8, commit ed5aebe"

    - id: "IMPROVEMENT-003"
      titulo: "Sincronizaci√≥n autom√°tica metadata en github.md"
      estado: "Propuesto"
      prioridad: "Media"
      resumen: "Planning: Separar memsys3_version (manual/milestone) de memsys3_commit (auto) y memsys3_last_push (auto). github.md actualiza commit+fecha, compile-context actualiza versi√≥n"
      opciones: "Opci√≥n A mejorada: 1A (endSession actualiza version), 2A (hash corto 7 chars), 3A (actualizar antes commit), 4 (problema fecha falsa si push falla)"
      referencias: "Sesi√≥n 2025-12-01, plan detallado ~/.claude/plans/cryptic-yawning-sutton.md"

    - id: "IMPROVEMENT-002"
      titulo: "Contexto espec√≠fico por prompt"
      estado: "Propuesto"
      prioridad: "Media"
      resumen: "Observaci√≥n: algunos prompts pueden requerir contexto espec√≠fico diferente al general. newSession carga context.yaml completo, pero compile-context no necesita newSession (instancia limpia), endSession podr√≠a no necesitar todo context"
      opciones: "4 opciones analizadas: Pre-requisitos expl√≠citos, Niveles de newSession, M√≠nimo+espec√≠fico, Autocontenidos"
      referencias: "Sesi√≥n 2025-11-17 (planning ~15min)"

    - id: "IMPROVEMENT-001"
      titulo: "Contexto con documentaci√≥n cr√≠tica del proyecto"
      estado: "Parcialmente Resuelto"
      prioridad: "Media"
      resumen: "README ya incluido en contexto (opcional, ADR-012 lo separ√≥). Evaluar si agregar OTROS documentos cr√≠ticos (DEVELOPMENT.md, UPDATE.md) seg√∫n necesidad. Conflicto con IMPROVEMENT-004 resuelto: 004 m√°s madura arquitect√≥nicamente"
      referencias: "Sesi√≥n 2025-11-03, reconsiderar post-IMPROVEMENT-004"

# ============================================
# NOTAS DE COMPILACI√ìN DEL CA
# Transparencia del proceso de compilaci√≥n
# ============================================
notas_compilacion:
  adrs_totales: "12 (en memory/full/adr.yaml)"
  adrs_incluidas: "8 seleccionadas (ADR-001, 002, 003, 005, 006, 008, 009, 012)"
  justificacion_adrs: "Criterio: impacto global arquitect√≥nico. Excluidas: ADR-007 (documentaci√≥n, menos impacto operativo), ADR-004 (decisi√≥n obvia en c√≥digo), ADR-010 (espec√≠fica deployment), ADR-011 (meta-desarrollo)"

  sesiones_totales: "15 (1 en sessions.yaml + 14 en sessions_1.yaml rotado)"
  sesiones_incluidas: "4 sintetizadas (2025-12-03 IMPROVEMENT-004 + rotaci√≥n, 2025-12-01 compilaci√≥n v1.9 + README sync, 2025-11-14 mejora CA an√°lisis README + backlog, 2025-11-14 feature backlog distribuible)"
  justificacion_sesiones: "Criterio: impacto arquitect√≥nico, features nuevas, cambios significativos. Excluidas: sesiones de fixes menores, traducciones, validaciones, deployment antiguo"

  gotchas_extraidos: "5 cr√≠ticos de m√∫ltiples sesiones"
  justificacion_gotchas: "Criterio: criticidad alta/media + relevancia actual + impacto en desarrollo. Seleccionados: endSession history folder, @ mentions ignorados, rotaci√≥n flexible, criterio CA inteligente, templates permanentes"

  backlog_existe: true
  backlog_items_totales: "7 (2 ISSUE, 1 FEATURE, 4 IMPROVEMENT)"
  backlog_items_incluidos: "5 (IMPROVEMENT-004 completado, ISSUE-002 pendiente, IMPROVEMENT-003 propuesta, IMPROVEMENT-002 propuesta, IMPROVEMENT-001 parcial)"
  justificacion_backlog: "Incluidos: items referenciados en pendientes + items prioridad media-alta + conflictos resueltos (IMPROVEMENT-001 vs 004). Excluidos: ISSUE-001 baja prioridad, FEATURE-002 completado (ya en sessions/ADRs)"

  tokens_iniciales: "~41,030 (164,122 caracteres √∑ 4)"
  tokens_finales_estimados: "~11,500 (context.yaml generado)"
  reduccion_tokens: "~72%"

  criterios_filtraje: |
    - ADRs: Impacto global arquitect√≥nico, decisiones no obvias, trade-offs importantes
    - Sessions: Cambios arquitect√≥nicos, features nuevas, problemas cr√≠ticos resueltos, decisiones que afectan futuro
    - Gotchas: Criticidad alta/media, errores que rompen el proyecto, comportamientos contra-intuitivos
    - Backlog: Items referenciados en pendientes, prioridad media-alta, estado abierto/en progreso

  archivamiento: "No activado (tokens muy por debajo de 150K). Plan de Contingencia disponible si se supera umbral"

  lineas_totales: "~480 l√≠neas de 2000 m√°ximo (24% capacidad, margen amplio para crecimiento)"

  observaciones: |
    ‚úÖ Primera compilaci√≥n POST-IMPROVEMENT-004 (ADR-012):
    - README NO incluido en context.yaml (separado seg√∫n Separation of Concerns)
    - README se lee directamente en newSession.md (identidad actual del proyecto)
    - context.yaml enfocado exclusivamente en memoria hist√≥rica (sessions, ADRs, gotchas)
    - ~95 l√≠neas ahorradas (~1.4K tokens) vs versi√≥n anterior

    ‚úÖ Primera compilaci√≥n tras rotaci√≥n real:
    - sessions_1.yaml (1849 l√≠neas) procesado correctamente
    - Sistema rotaci√≥n flexible (ADR-002 UPDATE 2025-12-03) documentado
    - Escenario A (post-documentar LITE) y Escenario B (pre-documentar) incluidos

    ‚úÖ Sistema backlog integrado:
    - Lectura selectiva de items referenciados funcionando
    - 5 de 7 items incluidos (criterio: referenciados + prioridad media-alta)
    - IMPROVEMENT-004 completado documentado, ISSUE-002 pendiente resuelto

    ‚úÖ Conflicto IMPROVEMENT-001 vs 004 resuelto:
    - ADR-012 documenta que 004 es arquitect√≥nicamente m√°s madura
    - IMPROVEMENT-001 pendiente de re-evaluaci√≥n para OTROS docs (DEVELOPMENT.md, UPDATE.md)

    Sistema en Development v1.9 con mejoras recientes significativas:
    - Context Agent mejorado: An√°lisis profundo README autom√°tico (PASO 7, 10 categor√≠as)
    - Integraci√≥n backlog selectiva (lee solo items referenciados)
    - README separado de context (ADR-012)
    - Sistema rotaci√≥n flexible documentado (ADR-002 actualizado)
    - Primera rotaci√≥n real ejecutada exitosamente

    Contexto compilado incluye 8 de 12 ADRs (67%) - todas arquitect√≥nicamente cr√≠ticas.
    √öltimas 4 sesiones sintetizadas con highlights principales.
    5 gotchas cr√≠ticos documentados con soluciones claras.
    5 pendientes top prioritarios para siguiente trabajo.

    Sistema escalable, robusto y maduro para proyectos de cualquier tama√±o.

# ============================================
# NOTAS DE USO
# ============================================
# Este archivo es COMPILADO autom√°ticamente, no editar manualmente
# Para actualizar: ejecutar @memsys3/prompts/compile-context.md
# Para m√°s detalles: ver memory/full/adr.yaml, memory/full/sessions.yaml, memory/full/sessions_1.yaml
# Si contexto demasiado grande: CA mover√° datos a memory/history/ (no le√≠do)
# README.md se lee directamente en newSession.md (ADR-012): identidad actual separada de memoria hist√≥rica
