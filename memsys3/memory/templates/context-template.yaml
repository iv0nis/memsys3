# Context Template
# Este es el archivo que carga DevAI para entender el proyecto
# Es compilado por el Context Agent (CA) desde memory/full/
# Límite ÚNICO: máximo 2000 líneas total
#
# NOTA: README.md se lee directamente en newSession.md (identidad actual del proyecto)
#       context.yaml contiene solo memoria histórica (sessions, ADRs, gotchas)

metadata:
  compilado_por: "Context Agent"
  ultima_compilacion: "[TIMESTAMP]"
  version_context: "[NUMERO_VERSIO]"

# ============================================
# PROJECT INFO
# ============================================
project:
  nombre: "[NOM_PROJECTE]"
  descripcion: "[DESCRIPCIÓ_1_LÍNIA]"
  fase: "[FASE_ACTUAL]"
  ultima_feature: "[ÚLTIMA_FEATURE]"
  siguiente_milestone: "[PRÒXIM_MILESTONE]"

# ============================================
# FEATURES OPERATIVES
# ============================================
features:
  feature_1:
    nombre: "[NOM]"
    url: "[URL]"
    estado: "[operativo|desarrollo|pendiente]"
    descripcion: "[DESCRIPCIÓ_BREU]"

  # CA añade tantas features como sea necesario

# ============================================
# STACK TECNOLÒGIC
# ============================================
stack:
  frontend: "[FRAMEWORK + VERSIÓ]"
  backend: "[RUNTIME + FRAMEWORK]"
  database: "[DATABASE si n'hi ha]"
  deploy: "[PLATFORM]"
  # Solo lo esencial del stack

# ============================================
# URLS PRINCIPALS
# ============================================
urls:
  production: "[URL_PRINCIPAL]"
  staging: "[URL_STAGING si n'hi ha]"
  # CA añade URLs relevantes

# ============================================
# ADRs RELEVANTES
# CA selecciona con criterioo inteligente según impacto global
# NO hay límite fijo, solo criterioo y 2000 líneas totales
# ============================================
adrs:
  - id: "001"
    titulo: "[TÍTOL_ADR]"
    decision: "[QUÈ ES VA DECIDIR]"
    motivo: "[PER QUÈ]"
    impacto: "[IMPACTE_GLOBAL]"

  # CA añade más ADRs según relevancia
  # Decisiones con impacto global, no obvias, arquitectónicas

# ============================================
# ÚLTIMA SESIÓN (o sesiones recientes)
# CA sintetiza sesiones más impactantes
# ============================================
ultima_sesion:
  data: "[YYYY-MM-DD]"
  duracion: "[~Xh]"
  que_es_va_fer:
    - "[FEATURE_PRINCIPAL_IMPLEMENTADA]"
    - "[PROBLEMA_SIGNIFICATIU_RESOLT]"
    - "[REFACTORING_IMPORTANT]"
  decisions:
    - "[DECISIÓ_TÈCNICA_PRESA]"
    - "[TRADE-OFF_ACCEPTAT]"
  proximos_pasos:
    - "[TASCA_PENDENT_IMPORTANT]"
    - "[BLOCKER_CONEGUT]"

# Si hay múltiples sesiones recientes relevantes, CA puede añadir más

# ============================================
# GOTCHAS CRÍTICOS
# Errores/configuraciones que rompen el proyecto si no se conocen
# CA filtra con criterioo: solo imprescindibles
# ============================================
gotchas:
  - id: "[ID_DESCRIPTIU]"
    problema: "[PROBLEMA_CRÍTIC]"
    solucio: "[COM_RESOLDRE]"

  # CA añade solo gotchas activos y críticos
  # Contra-intuitivos, que rompen desarrollo, repetitivos

# ============================================
# PENDIENTES PRIORITARIOS
# Tareas más importantes del proyecto ahora
# CA prioriza según project-status y contexto reciente
# ============================================
pendientes:
  - prioritat: 1
    tasca: "[TASCA_MÉS_CRÍTICA]"
    detall: "[PER_QUÈ_ÉS_IMPORTANT]"

  - prioritat: 2
    tasca: "[SEGONA_PRIORITAT]"
    detall: "[CONTEXT_ADDICIONAL]"

  # CA añade según prioridad real, no límite fijo

# ============================================
# BACKLOG (OPCIONAL - solo si existe memsys3/backlog/)
# Trabajo futuro pendiente: issues, features, improvements
# CA incluye SOLO items referenciados o críticos
# ============================================
backlog:
  sistema: |
    [Resumen del sistema de backlog desde README.md]
    - 6 tipos de items: ISSUE, FEATURE, SPEC, BLUEPRINT, IMPROVEMENT, EXPLORATION
    - Estados: Propuesto, Abierto, En Progreso, Bloqueado, Completado, Cancelado

  estadisticas:
    issues: "[N issues totales]"
    features: "[M features totales]"
    improvements: "[X improvements totales]"
    otros: "[Y otros (SPEC, BLUEPRINT, EXPLORATION)]"

  items_criticos:
    - id: "[TIPO-XXX]"
      titulo: "[Título del item]"
      estado: "[Abierto/En Progreso/etc]"
      prioridad: "[Alta/Media/Baja]"
      resumen: "[Breve descripción del problema/necesidad]"
      referencia: "[Si está referenciado en pendientes_prioritarios]"

    # CA añade SOLO:
    # 1. Items referenciados en project-status.yaml pendientes_prioritarios
    # 2. Items prioridad ALTA en estado Abierto/En Progreso
    # NO incluir: Completados, Cancelados, Baja prioridad sin referencias

# ============================================
# NOTAS DE COMPILACIÓN DEL CA
# Transparencia del proceso de compilación
# ============================================
notas_compilacion:
  adrs_totals: "[N total a memory/full/adr.yaml]"
  adrs_incluidas: "[M seleccionades per context]"
  sesiones_totales: "[X total a memory/full/sessions.yaml]"
  sesiones_incluidas: "[Y sintetitzades en context]"
  backlog_existe: "[true/false]"
  backlog_items_totales: "[N items totales en backlog/ si existe]"
  backlog_items_incluidos: "[M items incluidos en context (referenciados o críticos)]"
  justificacion_backlog: "[Por qué se incluyeron estos items: referenciados en pendientes, prioridad alta, etc.]"
  tokens_iniciales: "[Tokens llegits de full/]"
  tokens_finales: "[Tokens del context.yaml generat]"
  archivamiento: "[Si se ha activado Plan Contingencia: sessions/ADRs archivadas a history/]"
  criterioos_filtraje: "[Criteris inteligentes usados: impacte global, rellevància actual, etc.]"
  lineas_totales: "[~X líneas de 2000 máximo]"

# ============================================
# NOTAS DE USO
# ============================================
# Este archivo es COMPILADO automáticamente, no editar manualmente
# Para actualizar: ejecutar @memsys3/prompts/compile-context.md
# Para más detalles: ver memory/full/adr.yaml y memory/full/sessions.yaml
# Si contexto demasiado grande: CA moverá datos a memory/history/ (no leído)
